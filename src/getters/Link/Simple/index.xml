index:	0
title:	Simple
desc:	[L:Simple] <a href="http://tinyurl.com/">"http://tinyurl.com/"</a>

body:	
	<p>Status: OK 2009-10-24</p>
	<pre># $Id: Simple 11111 2010-01-13 13:09:39Z sparky $
# Link::Simple - Link retriever plugin for rsget.pl
#
# 2009-2010 (c) Przemys≈Çaw Iskra &lt;sparky@pld-linux.org&gt;
#		This program is free software,
# you may distribute it under GPL v2 or newer.

name: Simple
short: L:Simple
web: "http://tinyurl.com/"
uri: qr{4gk\.com/}
uri: qr{xurl\.jp/}
uri: qr{tinyurl\.com/}
uri: qr{linkhider\.com/}
slots: max
status: OK 2009-10-24

start:
	my $uri = $-{_uri};
	$uri =~ s#(xurl.*)\.html#$1#;
	GET( $uri );
	$-{_uri} =~ m#^(http://.*?/)#;
	my $serv = quotemeta $1;

	my $link;
	if ( $-{_referer} =~ m#^$serv# ) {
		if ( m#&lt;meta http-equiv="refresh" content="\d+;url='(.*?)'"&gt;#i ) {
			$link = $1;
		} elsif ( m#&lt;i?frame\s+.*?src="(http://.*?)"&gt;#i ) {
			$link = $1;
		} else {
			ERROR( "can't find link" );
		}
	} else {
		$link = $-{_referer};
	}

	LINK( $link );

# vim: filetype=perl:ts=4:sw=4
</pre>
